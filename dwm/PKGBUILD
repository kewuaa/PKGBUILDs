pkgname=dwm
pkgver="0.1.0"
pkgrel=1
arch=("x86_64")
depends=(
    # font
    "ttf-firacode-nerd"
    # alpha needed
    "picom"
    # background image
    "feh"
    # snapshot
    "flameshot"
    # adjust light
    "acpilight"
    # adjust volume
    "alsa-utils"
    # screen locker
    "xautolock"
)
makedepends=("git" "gcc")


prepare() {
    git clone -b alpha --single-branch https://github.com/kewuaa/dwm.git
    git clone -b alpha --single-branch https://github.com/kewuaa/st.git
    git clone -b alpha --single-branch https://github.com/kewuaa/dmenu.git
    git clone -b custom --single-branch https://github.com/kewuaa/slstatus.git
    git clone -b custom --single-branch https://github.com/kewuaa/slock.git
    sed -i "/tic -sx st.info/d" st/Makefile
}


build() {
    lst=("dwm" "st" "dmenu" "slstatus" "slock")
    for name in "${lst[@]}"
    do
        cd ${srcdir}/${name}
        make
    done
}

package() {
    lst=("dwm" "st" "dmenu" "slstatus" "slock")
    mkdir -p ${pkgdir}/usr/local/man
    mkdir -p ${pkgdir}/usr/local/share
    ln -s ${pkgdir}/usr/local/man ${pkgdir}/usr/local/share/man
    for name in "${lst[@]}"
    do
        cd ${srcdir}/${name}
        make DESTDIR="${pkgdir}" install
    done
    unlink ${pkgdir}/usr/local/share/man
    mkdir -p ${pkgdir}/usr/share/terminfo
    tic -sx -o ${pkgdir}/usr/share/terminfo ${srcdir}/st/st.info
}
